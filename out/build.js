(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u="@myMoney:transactions",s="active",a="body-locked",l=function(){function t(){e(this,t),this._wrapper=document.querySelector(".modal-overlay"),this._openButton=document.querySelector(".new"),this._form=document.querySelector("#form")}return n(t,[{key:"handleSubmit",value:function(e){}},{key:"handleOutsideClick",value:function(e){!function(e,t,n){e.target===t&&(t.classList.remove(s),n())}(e,this._wrapper,this.close)}},{key:"open",value:function(e){e.preventDefault(),this._wrapper.classList.add(s),document.body.classList.add(a),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("click",this.handleOutsideClick)}},{key:"handleKeyUp",value:function(e){"Escape"===e.key&&this.close()}},{key:"close",value:function(){this._wrapper.classList.remove(s),document.body.classList.remove(a),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("click",this.handleOutsideClick)}},{key:"events",value:function(){var e=this;this._openButton.addEventListener("click",(function(t){return e.open(t)})),this._form.addEventListener("submit",(function(t){return e.handleSubmit(t)}))}},{key:"bindEvents",value:function(){this.close=this.close.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleOutsideClick=this.handleOutsideClick.bind(this)}}]),t}();function d(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}var f=function(){function t(){e(this,t),this._expenseCard=document.querySelector("#expenseDisplay"),this._incomeCard=document.querySelector("#incomeDisplay"),this._totalCard=document.querySelector("#totalDisplay")}return n(t,[{key:"showValues",value:function(e){var t=this.listAll(e),n=t.income,r=t.expenses,i=n-r;this._expenseCard.innerText=d(r),this._incomeCard.innerText=d(n),this._totalCard.innerText=d(i)}},{key:"listAll",value:function(e){var t,n;return{income:null===(t=null==e?void 0:e.filter((function(e){return"income"===e.type})))||void 0===t?void 0:t.reduce((function(e,t){return e+Number(t.amount)}),0),expenses:null===(n=null==e?void 0:e.filter((function(e){return"expense"===e.type})))||void 0===n?void 0:n.reduce((function(e,t){return e+Number(t.amount)}),0)}}}]),t}(),h=new l,y=new f;var p=new(function(){function t(){e(this,t),this.transactions=[],this._transactionsWrapper=document.querySelector("#data-table tbody"),this.list(),this.renderDom()}return n(t,[{key:"create",value:function(e){var t;this.transactions.push(e),this.addToDom(e),t=this.transactions,localStorage.setItem(u,JSON.stringify(t)),h.close(),y.showValues(this.transactions)}},{key:"addToDom",value:function(e){this._transactionsWrapper.insertAdjacentHTML("afterbegin",function(e){return"\n    <tr>\n      <td>".concat(e.title,"</td>\n      <td>").concat(e.description,"</td>\n      <td style=").concat("income"===e.type?"color:green":"color:red",">").concat(d(e.amount),"</td>\n      <td>").concat((t=e.created_at,new Intl.DateTimeFormat("pt-BR").format(t)),"</td>\n    </tr>\n  ");var t}(e))}},{key:"renderDom",value:function(){var e=this;return this.transactions.forEach((function(t){return e.addToDom(t)})),this.transactions}},{key:"list",value:function(){var e=JSON.parse(localStorage.getItem(u))||[];return this.transactions=e,this.transactions}}]),t}());new(function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(l,t);var i,u,a=(i=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(i);if(u){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return o(this,e)});function l(){var t;return e(this,l),(t=a.call(this))._type="income",t._titleField=document.querySelector("#title"),t._descriptionField=document.querySelector("#description"),t._amountField=document.querySelector("#amount"),t._typeFields=document.querySelectorAll(".input-group [data-option]"),t.typeEvent(),t.bindEvents(),t.events(),t}return n(l,[{key:"clearFields",value:function(){this._titleField.value="",this._descriptionField.value="",this._amountField.value=""}},{key:"handleChangeType",value:function(e,t){e.preventDefault();var n=e.currentTarget;this._typeFields.forEach((function(e){return e.classList.remove(s)})),this._typeFields[t].classList.add(s),this._type=n.dataset.option}},{key:"handleSubmit",value:function(e){e.preventDefault(),p.create({title:this._titleField.value,description:this._descriptionField.value,amount:Number(this._amountField.value),created_at:(new Date).getTime(),type:this._type}),this.close(),this.clearFields()}},{key:"typeEvent",value:function(){var e=this;this._typeFields.forEach((function(t,n){return t.addEventListener("click",(function(t){return e.handleChangeType(t,n)}))}))}}]),l}(l)),(new f).showValues(p.transactions)})();